# Mac で秘密鍵と公開鍵の作り方

このページは GitHub 公式の SSH 接続用の RSA 秘密鍵と公開鍵の作り方を元に、一部を和訳したものです。

- [Generating a new SSH key and adding it to the ssh-agent | Mac](https://help.github.com/articles/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent/#platform-mac) @ GitHub Help

## 事前に用意するもの

- GitHub のアカウント
    - 登録時のメールアドレス

## 事前確認

以下の手順で、すでに作成済みの秘密鍵と公開鍵がないか確認します。

Finder のメニューの「移動」→「フォルダへ移動...」で、以下のフォルダの場所を入力して「移動」します。

```
~/.ssh
```

フォルダが開かず「フォルダが見つかりません。」と表示されれば、鍵は未作成なので、次の作成ステップに進みます。

もしフォルダが開き「id_rsa」や「id_rsa.pub」といったファイルがあった場合は、過去に秘密鍵と公開鍵を作成済みということになります。


## 新しい秘密鍵と公開鍵のペア・キーを作成する

1. ターミナルを開きます。
    - 画面右上の 🔍 「Spotlight検索」から「ターミナル.app」と検索して起動

1. ターミナルに以下を入力します。"`your_email@example.com`" は GitHub に登録したメールアドレスに置き換えます。

    ```bash
    ssh-keygen -t rsa -b 4096 -C "your_email@example.com"
    ```

    以下のメッセージが表示されるので、しばらく待ちます。
    
    ```
    Generating public/private rsa key pair.
    ```

1. 以下のメッセージが表示されたら "enter" キーでスキップし、次のステップに進みます。

    ```
    Enter a file in which to save the key (/Users/you/.ssh/id_rsa): [Press enter]
    ```

    "/Users/you/.ssh/id_rsa" の "you" は自分のアカウント名になっています。

1. 以下のメッセージが表示されたら、パスフレーズを使う場合はパスフレーズを入力し、パスフレーズを使わない場合は "enter" キーを押します。（各々２回操作を聞かれます）

    ```
    Enter passphrase (empty for no passphrase): [Type a passphrase]
    Enter same passphrase again: [Type passphrase again]
    ```
    
    - 「パスフレーズ」とは
    
        「パスフレーズ」は、**公開鍵／秘密鍵を利用するたびに聞かれるパスワードのこと**です。これを設定しておくと、秘密鍵がコピーされたり流出してもパスフレーズを入力しないと鍵を利用することができなくなります。逆に、パスフレーズを設定すると、復号（暗号化を解読）するたびにパスフレーズを聞かれるようになります。

## 作成された鍵（秘密鍵と公開鍵）の確認

上記で作成された秘密鍵と公開鍵のペアは、ユーザーのホームディレクトリの「`.ssh`」という名前の隠しフォルダに保存されます。以下のいずれかで開き、確認することができます。

### ターミナルから保存フォルダを開く

ターミナルを開き、以下のコマンドを打って `enter` キーでフォルダが開きます。

```
open ~/.ssh
```

### Finder メニューから開く

Finder のメニューの「移動」→「フォルダへ移動...」で、以下のフォルダの場所を入力して「移動」します。フォルダが存在すると開きます。

```
~/.ssh
```

## 鍵の説明

- "id_rsa"

    秘密鍵です。ペアとなる公開鍵で暗号化されたファイルを復号（暗号化を解読）するのに必要になるので、**絶対に人に渡してはいけません**。

- "id_rsa.pub"

    秘密鍵のペアとなる公開鍵で、**関係者に渡す鍵**です。ペアとなる秘密鍵で暗号化されたファイルを復号するのに使われたり、ペアとなる秘密鍵で署名されたファイルを確認するのに使われます。

